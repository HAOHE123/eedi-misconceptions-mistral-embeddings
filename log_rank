nohup: ignoring input
valid_mapk_score = 0.4775474895433248
llm reranker: /root/autodl-tmp/bert-models/upstage/SOLAR-10.7B-Instruct-v1.0
Loading checkpoint shards:   0%|                                                               | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|███████████                                            | 1/5 [00:01<00:06,  1.72s/it]Loading checkpoint shards:  40%|██████████████████████                                 | 2/5 [00:03<00:05,  1.76s/it]Loading checkpoint shards:  60%|█████████████████████████████████                      | 3/5 [00:04<00:03,  1.62s/it]Loading checkpoint shards:  80%|████████████████████████████████████████████           | 4/5 [00:06<00:01,  1.66s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████| 5/5 [00:07<00:00,  1.26s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████| 5/5 [00:07<00:00,  1.45s/it]
  0%|                                                                                       | 0/1360 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
  0%|                                                                             | 1/1360 [00:03<1:14:02,  3.27s/it]  0%|                                                                               | 2/1360 [00:04<51:17,  2.27s/it]  0%|▏                                                                              | 3/1360 [00:06<41:08,  1.82s/it]  0%|▏                                                                              | 4/1360 [00:07<36:21,  1.61s/it]  0%|▎                                                                              | 5/1360 [00:08<34:10,  1.51s/it]  0%|▎                                                                              | 6/1360 [00:09<31:41,  1.40s/it]  1%|▍                                                                              | 7/1360 [00:11<31:02,  1.38s/it]  1%|▍                                                                              | 8/1360 [00:12<30:22,  1.35s/it]  1%|▌                                                                              | 9/1360 [00:13<29:55,  1.33s/it]  1%|▌                                                                             | 10/1360 [00:15<29:36,  1.32s/it]  1%|▋                                                                             | 11/1360 [00:16<29:23,  1.31s/it]  1%|▋                                                                             | 12/1360 [00:17<29:14,  1.30s/it]  1%|▋                                                                             | 13/1360 [00:18<29:07,  1.30s/it]  1%|▊                                                                             | 14/1360 [00:20<28:03,  1.25s/it]  1%|▊                                                                             | 15/1360 [00:21<27:25,  1.22s/it]  1%|▉                                                                             | 16/1360 [00:22<27:00,  1.21s/it]  1%|▉                                                                             | 17/1360 [00:23<26:40,  1.19s/it]  1%|█                                                                             | 18/1360 [00:24<26:26,  1.18s/it]  1%|█                                                                             | 19/1360 [00:26<27:07,  1.21s/it]  1%|█▏                                                                            | 20/1360 [00:27<25:46,  1.15s/it]  2%|█▏                                                                            | 21/1360 [00:28<26:03,  1.17s/it]  2%|█▎                                                                            | 22/1360 [00:29<26:14,  1.18s/it]  2%|█▎                                                                            | 23/1360 [00:30<26:21,  1.18s/it]  2%|█▍                                                                            | 24/1360 [00:31<26:26,  1.19s/it]  2%|█▍                                                                            | 25/1360 [00:32<26:01,  1.17s/it]  2%|█▍                                                                            | 26/1360 [00:34<26:11,  1.18s/it]  2%|█▌                                                                            | 27/1360 [00:35<26:17,  1.18s/it]  2%|█▌                                                                            | 28/1360 [00:36<26:22,  1.19s/it]  2%|█▋                                                                            | 29/1360 [00:37<26:24,  1.19s/it]  2%|█▋                                                                            | 30/1360 [00:38<26:26,  1.19s/it]  2%|█▊                                                                            | 31/1360 [00:40<26:26,  1.19s/it]  2%|█▊                                                                            | 32/1360 [00:41<26:26,  1.19s/it]  2%|█▉                                                                            | 33/1360 [00:42<26:26,  1.20s/it]  2%|█▉                                                                            | 34/1360 [00:43<26:26,  1.20s/it]  3%|██                                                                            | 35/1360 [00:44<26:26,  1.20s/it]  3%|██                                                                            | 36/1360 [00:46<25:58,  1.18s/it]  3%|██                                                                            | 37/1360 [00:47<26:05,  1.18s/it]  3%|██▏                                                                           | 38/1360 [00:48<26:10,  1.19s/it]  3%|██▏                                                                           | 39/1360 [00:49<26:07,  1.19s/it]  3%|██▎                                                                           | 40/1360 [00:50<26:04,  1.19s/it]  3%|██▎                                                                           | 41/1360 [00:52<26:02,  1.18s/it]  3%|██▍                                                                           | 42/1360 [00:53<25:33,  1.16s/it]  3%|██▍                                                                           | 43/1360 [00:54<25:13,  1.15s/it]  3%|██▌                                                                           | 44/1360 [00:55<24:58,  1.14s/it]  3%|██▌                                                                           | 45/1360 [00:56<25:15,  1.15s/it]  3%|██▋                                                                           | 46/1360 [00:57<25:26,  1.16s/it]  3%|██▋                                                                           | 47/1360 [00:58<25:06,  1.15s/it]  4%|██▊                                                                           | 48/1360 [01:00<25:19,  1.16s/it]  4%|██▊                                                                           | 49/1360 [01:01<25:01,  1.15s/it]  4%|██▊                                                                           | 50/1360 [01:02<24:54,  1.14s/it]  4%|██▉                                                                           | 51/1360 [01:03<24:43,  1.13s/it]  4%|██▉                                                                           | 52/1360 [01:04<25:01,  1.15s/it]  4%|███                                                                           | 53/1360 [01:05<25:14,  1.16s/it]  4%|███                                                                           | 54/1360 [01:06<24:56,  1.15s/it]  4%|███▏                                                                          | 55/1360 [01:08<24:44,  1.14s/it]  4%|███▏                                                                          | 56/1360 [01:09<24:34,  1.13s/it]  4%|███▎                                                                          | 57/1360 [01:10<24:53,  1.15s/it]  4%|███▎                                                                          | 58/1360 [01:11<24:40,  1.14s/it]  4%|███▍                                                                          | 59/1360 [01:12<24:30,  1.13s/it]  4%|███▍                                                                          | 60/1360 [01:13<24:15,  1.12s/it]  4%|███▍                                                                          | 61/1360 [01:14<24:04,  1.11s/it]  5%|███▌                                                                          | 62/1360 [01:15<23:56,  1.11s/it]  5%|███▌                                                                          | 63/1360 [01:16<24:11,  1.12s/it]  5%|███▋                                                                          | 64/1360 [01:18<24:28,  1.13s/it]  5%|███▋                                                                          | 65/1360 [01:19<23:42,  1.10s/it]  5%|███▊                                                                          | 66/1360 [01:20<23:39,  1.10s/it]  5%|███▊                                                                          | 67/1360 [01:21<23:37,  1.10s/it]  5%|███▉                                                                          | 68/1360 [01:22<23:35,  1.10s/it]  5%|███▉                                                                          | 69/1360 [01:23<23:33,  1.10s/it]  5%|████                                                                          | 70/1360 [01:24<23:40,  1.10s/it]  5%|████                                                                          | 71/1360 [01:25<23:57,  1.12s/it]  5%|████▏                                                                         | 72/1360 [01:26<24:09,  1.13s/it]  5%|████▏                                                                         | 73/1360 [01:28<24:17,  1.13s/it]  5%|████▏                                                                         | 74/1360 [01:29<24:22,  1.14s/it]  6%|████▎                                                                         | 75/1360 [01:30<23:35,  1.10s/it]  6%|████▎                                                                         | 76/1360 [01:31<23:52,  1.12s/it]  6%|████▍                                                                         | 77/1360 [01:32<23:42,  1.11s/it]  6%|████▍                                                                         | 78/1360 [01:33<23:35,  1.10s/it]  6%|████▌                                                                         | 79/1360 [01:34<23:51,  1.12s/it]  6%|████▌                                                                         | 80/1360 [01:35<24:02,  1.13s/it]  6%|████▋                                                                         | 81/1360 [01:37<24:09,  1.13s/it]  6%|████▋                                                                         | 82/1360 [01:38<23:53,  1.12s/it]  6%|████▊                                                                         | 83/1360 [01:39<24:02,  1.13s/it]  6%|████▊                                                                         | 84/1360 [01:40<24:08,  1.14s/it]  6%|████▉                                                                         | 85/1360 [01:41<23:22,  1.10s/it]  6%|████▉                                                                         | 86/1360 [01:42<22:49,  1.08s/it]  6%|████▉                                                                         | 87/1360 [01:43<23:16,  1.10s/it]  6%|█████                                                                         | 88/1360 [01:44<23:14,  1.10s/it]  7%|█████                                                                         | 89/1360 [01:45<22:43,  1.07s/it]  7%|█████▏                                                                        | 90/1360 [01:46<22:21,  1.06s/it]  7%|█████▏                                                                        | 91/1360 [01:47<22:05,  1.04s/it]  7%|█████▎                                                                        | 92/1360 [01:48<21:54,  1.04s/it]  7%|█████▎                                                                        | 93/1360 [01:49<22:36,  1.07s/it]  7%|█████▍                                                                        | 94/1360 [01:50<22:15,  1.05s/it]  7%|█████▍                                                                        | 95/1360 [01:51<22:00,  1.04s/it]  7%|█████▌                                                                        | 96/1360 [01:52<21:49,  1.04s/it]  7%|█████▌                                                                        | 97/1360 [01:54<21:41,  1.03s/it]  7%|█████▌                                                                        | 98/1360 [01:55<22:17,  1.06s/it]  7%|█████▋                                                                        | 99/1360 [01:56<22:00,  1.05s/it]  7%|█████▋                                                                       | 100/1360 [01:57<21:48,  1.04s/it]  7%|█████▋                                                                       | 101/1360 [01:58<22:21,  1.07s/it]  8%|█████▊                                                                       | 102/1360 [01:59<22:44,  1.08s/it]  8%|█████▊                                                                       | 103/1360 [02:00<22:18,  1.06s/it]  8%|█████▉                                                                       | 104/1360 [02:01<21:59,  1.05s/it]  8%|█████▉                                                                       | 105/1360 [02:02<21:31,  1.03s/it]  8%|██████                                                                       | 106/1360 [02:03<21:25,  1.03s/it]  8%|██████                                                                       | 107/1360 [02:04<21:22,  1.02s/it]  8%|██████                                                                       | 108/1360 [02:05<21:19,  1.02s/it]  8%|██████▏                                                                      | 109/1360 [02:06<21:03,  1.01s/it]  8%|██████▏                                                                      | 110/1360 [02:07<21:05,  1.01s/it]  8%|██████▎                                                                      | 111/1360 [02:08<20:54,  1.00s/it]  8%|██████▎                                                                      | 112/1360 [02:09<20:58,  1.01s/it]  8%|██████▍                                                                      | 113/1360 [02:10<21:00,  1.01s/it]  8%|██████▍                                                                      | 114/1360 [02:11<21:02,  1.01s/it]  8%|██████▌                                                                      | 115/1360 [02:12<21:02,  1.01s/it]  9%|██████▌                                                                      | 116/1360 [02:13<21:03,  1.02s/it]  9%|██████▌                                                                      | 117/1360 [02:14<21:02,  1.02s/it]  9%|██████▋                                                                      | 118/1360 [02:15<21:02,  1.02s/it]  9%|██████▋                                                                      | 119/1360 [02:16<21:01,  1.02s/it]  9%|██████▊                                                                      | 120/1360 [02:17<21:01,  1.02s/it]  9%|██████▊                                                                      | 121/1360 [02:18<20:47,  1.01s/it]  9%|██████▉                                                                      | 122/1360 [02:19<20:50,  1.01s/it]  9%|██████▉                                                                      | 123/1360 [02:20<20:39,  1.00s/it]  9%|███████                                                                      | 124/1360 [02:21<20:44,  1.01s/it]  9%|███████                                                                      | 125/1360 [02:22<20:47,  1.01s/it]  9%|███████▏                                                                     | 126/1360 [02:23<20:49,  1.01s/it]  9%|███████▏                                                                     | 127/1360 [02:24<20:20,  1.01it/s]  9%|███████▏                                                                     | 128/1360 [02:25<20:29,  1.00it/s]  9%|███████▎                                                                     | 129/1360 [02:26<20:35,  1.00s/it] 10%|███████▎                                                                     | 130/1360 [02:27<20:27,  1.00it/s] 10%|███████▍                                                                     | 131/1360 [02:28<20:33,  1.00s/it] 10%|███████▍                                                                     | 132/1360 [02:29<20:39,  1.01s/it] 10%|███████▌                                                                     | 133/1360 [02:30<20:29,  1.00s/it] 10%|███████▌                                                                     | 134/1360 [02:31<20:21,  1.00it/s] 10%|███████▋                                                                     | 135/1360 [02:32<20:28,  1.00s/it] 10%|███████▋                                                                     | 136/1360 [02:33<20:33,  1.01s/it] 10%|███████▊                                                                     | 137/1360 [02:34<20:21,  1.00it/s] 10%|███████▊                                                                     | 138/1360 [02:35<20:27,  1.00s/it] 10%|███████▊                                                                     | 139/1360 [02:36<20:31,  1.01s/it] 10%|███████▉                                                                     | 140/1360 [02:37<20:21,  1.00s/it] 10%|███████▉                                                                     | 141/1360 [02:38<20:26,  1.01s/it] 10%|████████                                                                     | 142/1360 [02:39<20:29,  1.01s/it] 11%|████████                                                                     | 143/1360 [02:40<20:31,  1.01s/it] 11%|████████▏                                                                    | 144/1360 [02:41<20:32,  1.01s/it] 11%|████████▏                                                                    | 145/1360 [02:42<20:32,  1.01s/it] 11%|████████▎                                                                    | 146/1360 [02:43<20:01,  1.01it/s] 11%|████████▎                                                                    | 147/1360 [02:44<20:10,  1.00it/s] 11%|████████▍                                                                    | 148/1360 [02:45<19:47,  1.02it/s] 11%|████████▍                                                                    | 149/1360 [02:46<19:46,  1.02it/s] 11%|████████▍                                                                    | 150/1360 [02:47<19:59,  1.01it/s] 11%|████████▌                                                                    | 151/1360 [02:48<20:07,  1.00it/s] 11%|████████▌                                                                    | 152/1360 [02:49<20:13,  1.00s/it] 11%|████████▋                                                                    | 153/1360 [02:50<20:17,  1.01s/it] 11%|████████▋                                                                    | 154/1360 [02:51<20:19,  1.01s/it] 11%|████████▊                                                                    | 155/1360 [02:52<20:20,  1.01s/it] 11%|████████▊                                                                    | 156/1360 [02:53<20:21,  1.01s/it] 12%|████████▉                                                                    | 157/1360 [02:54<20:21,  1.02s/it] 12%|████████▉                                                                    | 158/1360 [02:55<20:21,  1.02s/it] 12%|█████████                                                                    | 159/1360 [02:56<20:08,  1.01s/it] 12%|█████████                                                                    | 160/1360 [02:57<19:40,  1.02it/s] 12%|█████████                                                                    | 161/1360 [02:58<19:51,  1.01it/s] 12%|█████████▏                                                                   | 162/1360 [02:59<19:46,  1.01it/s] 12%|█████████▏                                                                   | 163/1360 [03:00<19:55,  1.00it/s] 12%|█████████▎                                                                   | 164/1360 [03:01<20:01,  1.00s/it] 12%|█████████▎                                                                   | 165/1360 [03:02<19:52,  1.00it/s] 12%|█████████▍                                                                   | 166/1360 [03:03<19:58,  1.00s/it] 12%|█████████▍                                                                   | 167/1360 [03:04<19:50,  1.00it/s] 12%|█████████▌                                                                   | 168/1360 [03:05<19:56,  1.00s/it] 12%|█████████▌                                                                   | 169/1360 [03:06<19:48,  1.00it/s] 12%|█████████▋                                                                   | 170/1360 [03:07<19:54,  1.00s/it] 13%|█████████▋                                                                   | 171/1360 [03:08<19:46,  1.00it/s] 13%|█████████▋                                                                   | 172/1360 [03:09<19:52,  1.00s/it] 13%|█████████▊                                                                   | 173/1360 [03:10<19:56,  1.01s/it] 13%|█████████▊                                                                   | 174/1360 [03:11<19:59,  1.01s/it] 13%|█████████▉                                                                   | 175/1360 [03:12<20:00,  1.01s/it] 13%|█████████▉                                                                   | 176/1360 [03:13<20:01,  1.01s/it] 13%|██████████                                                                   | 177/1360 [03:14<20:01,  1.02s/it] 13%|██████████                                                                   | 178/1360 [03:15<20:01,  1.02s/it] 13%|██████████▏                                                                  | 179/1360 [03:16<19:50,  1.01s/it] 13%|██████████▏                                                                  | 180/1360 [03:17<19:41,  1.00s/it] 13%|██████████▏                                                                  | 181/1360 [03:18<19:34,  1.00it/s] 13%|██████████▎                                                                  | 182/1360 [03:19<19:40,  1.00s/it] 13%|██████████▎                                                                  | 183/1360 [03:20<19:33,  1.00it/s] 14%|██████████▍                                                                  | 184/1360 [03:21<19:27,  1.01it/s] 14%|██████████▍                                                                  | 185/1360 [03:22<19:35,  1.00s/it] 14%|██████████▌                                                                  | 186/1360 [03:23<19:40,  1.01s/it] 14%|██████████▌                                                                  | 187/1360 [03:24<19:43,  1.01s/it] 14%|██████████▋                                                                  | 188/1360 [03:25<19:33,  1.00s/it] 14%|██████████▋                                                                  | 189/1360 [03:26<19:26,  1.00it/s] 14%|██████████▊                                                                  | 190/1360 [03:27<19:33,  1.00s/it] 14%|██████████▊                                                                  | 191/1360 [03:28<19:25,  1.00it/s] 14%|██████████▊                                                                  | 192/1360 [03:29<19:19,  1.01it/s] 14%|██████████▉                                                                  | 193/1360 [03:30<19:15,  1.01it/s] 14%|██████████▉                                                                  | 194/1360 [03:31<19:12,  1.01it/s] 14%|███████████                                                                  | 195/1360 [03:32<19:09,  1.01it/s] 14%|███████████                                                                  | 196/1360 [03:33<18:53,  1.03it/s] 14%|███████████▏                                                                 | 197/1360 [03:34<18:55,  1.02it/s] 15%|███████████▏                                                                 | 198/1360 [03:35<18:57,  1.02it/s] 15%|███████████▎                                                                 | 199/1360 [03:36<18:58,  1.02it/s] 15%|███████████▎                                                                 | 200/1360 [03:37<18:58,  1.02it/s] 15%|███████████▍                                                                 | 201/1360 [03:38<18:58,  1.02it/s] 15%|███████████▍                                                                 | 202/1360 [03:39<18:57,  1.02it/s] 15%|███████████▍                                                                 | 203/1360 [03:40<18:57,  1.02it/s] 15%|███████████▌                                                                 | 204/1360 [03:41<18:56,  1.02it/s] 15%|███████████▌                                                                 | 205/1360 [03:42<18:55,  1.02it/s] 15%|███████████▋                                                                 | 206/1360 [03:43<18:54,  1.02it/s] 15%|███████████▋                                                                 | 207/1360 [03:44<18:37,  1.03it/s] 15%|███████████▊                                                                 | 208/1360 [03:45<18:41,  1.03it/s] 15%|███████████▊                                                                 | 209/1360 [03:46<18:44,  1.02it/s] 15%|███████████▉                                                                 | 210/1360 [03:47<18:45,  1.02it/s] 16%|███████████▉                                                                 | 211/1360 [03:48<18:46,  1.02it/s] 16%|████████████                                                                 | 212/1360 [03:49<18:46,  1.02it/s] 16%|████████████                                                                 | 213/1360 [03:50<18:46,  1.02it/s] 16%|████████████                                                                 | 214/1360 [03:51<18:45,  1.02it/s] 16%|████████████▏                                                                | 215/1360 [03:52<18:43,  1.02it/s] 16%|████████████▏                                                                | 216/1360 [03:53<18:25,  1.03it/s] 16%|████████████▎                                                                | 217/1360 [03:54<18:30,  1.03it/s] 16%|████████████▎                                                                | 218/1360 [03:55<18:17,  1.04it/s] 16%|████████████▍                                                                | 219/1360 [03:56<18:22,  1.03it/s] 16%|████████████▍                                                                | 220/1360 [03:57<18:26,  1.03it/s] 16%|████████████▌                                                                | 221/1360 [03:58<18:13,  1.04it/s] 16%|████████████▌                                                                | 222/1360 [03:59<18:18,  1.04it/s] 16%|████████████▋                                                                | 223/1360 [03:59<18:05,  1.05it/s] 16%|████████████▋                                                                | 224/1360 [04:00<18:13,  1.04it/s] 17%|████████████▋                                                                | 225/1360 [04:01<18:17,  1.03it/s] 17%|████████████▊                                                                | 226/1360 [04:02<18:20,  1.03it/s] 17%|████████████▊                                                                | 227/1360 [04:03<18:22,  1.03it/s] 17%|████████████▉                                                                | 228/1360 [04:04<18:25,  1.02it/s] 17%|████████████▉                                                                | 229/1360 [04:05<18:25,  1.02it/s] 17%|█████████████                                                                | 230/1360 [04:06<18:24,  1.02it/s] 17%|█████████████                                                                | 231/1360 [04:07<17:54,  1.05it/s] 17%|█████████████▏                                                               | 232/1360 [04:08<18:02,  1.04it/s] 17%|█████████████▏                                                               | 233/1360 [04:09<17:53,  1.05it/s] 17%|█████████████▏                                                               | 234/1360 [04:10<18:01,  1.04it/s] 17%|█████████████▎                                                               | 235/1360 [04:11<18:06,  1.04it/s] 17%|█████████████▎                                                               | 236/1360 [04:12<18:11,  1.03it/s] 17%|█████████████▍                                                               | 237/1360 [04:13<18:13,  1.03it/s] 18%|█████████████▍                                                               | 238/1360 [04:14<17:58,  1.04it/s] 18%|█████████████▌                                                               | 239/1360 [04:15<17:47,  1.05it/s] 18%|█████████████▌                                                               | 240/1360 [04:16<17:55,  1.04it/s] 18%|█████████████▋                                                               | 241/1360 [04:17<17:46,  1.05it/s] 18%|█████████████▋                                                               | 242/1360 [04:18<17:56,  1.04it/s] 18%|█████████████▊                                                               | 243/1360 [04:19<18:01,  1.03it/s] 18%|█████████████▊                                                               | 244/1360 [04:20<17:48,  1.04it/s] 18%|█████████████▊                                                               | 245/1360 [04:21<17:40,  1.05it/s] 18%|█████████████▉                                                               | 246/1360 [04:22<17:50,  1.04it/s] 18%|█████████████▉                                                               | 247/1360 [04:23<17:26,  1.06it/s] 18%|██████████████                                                               | 248/1360 [04:24<17:38,  1.05it/s] 18%|██████████████                                                               | 249/1360 [04:24<17:32,  1.06it/s] 18%|██████████████▏                                                              | 250/1360 [04:25<17:42,  1.04it/s] 18%|██████████████▏                                                              | 251/1360 [04:26<17:19,  1.07it/s] 19%|██████████████▎                                                              | 252/1360 [04:27<17:18,  1.07it/s] 19%|██████████████▎                                                              | 253/1360 [04:28<17:16,  1.07it/s] 19%|██████████████▍                                                              | 254/1360 [04:29<17:15,  1.07it/s] 19%|██████████████▍                                                              | 255/1360 [04:30<17:14,  1.07it/s] 19%|██████████████▍                                                              | 256/1360 [04:31<17:27,  1.05it/s] 19%|██████████████▌                                                              | 257/1360 [04:32<17:36,  1.04it/s] 19%|██████████████▌                                                              | 258/1360 [04:33<17:26,  1.05it/s] 19%|██████████████▋                                                              | 259/1360 [04:34<17:19,  1.06it/s] 19%|██████████████▋                                                              | 260/1360 [04:35<17:16,  1.06it/s] 19%|██████████████▊                                                              | 261/1360 [04:36<17:27,  1.05it/s] 19%|██████████████▊                                                              | 262/1360 [04:37<17:20,  1.05it/s] 19%|██████████████▉                                                              | 263/1360 [04:38<17:16,  1.06it/s] 19%|██████████████▉                                                              | 264/1360 [04:39<17:14,  1.06it/s] 19%|███████████████                                                              | 265/1360 [04:40<17:24,  1.05it/s] 20%|███████████████                                                              | 266/1360 [04:41<17:17,  1.05it/s] 20%|███████████████                                                              | 267/1360 [04:42<17:27,  1.04it/s] 20%|███████████████▏                                                             | 268/1360 [04:42<17:19,  1.05it/s] 20%|███████████████▏                                                             | 269/1360 [04:43<17:13,  1.06it/s] 20%|███████████████▎                                                             | 270/1360 [04:44<17:07,  1.06it/s] 20%|███████████████▎                                                             | 271/1360 [04:45<16:49,  1.08it/s] 20%|███████████████▍                                                             | 272/1360 [04:46<16:51,  1.08it/s] 20%|███████████████▍                                                             | 273/1360 [04:47<17:06,  1.06it/s] 20%|███████████████▌                                                             | 274/1360 [04:48<17:03,  1.06it/s] 20%|███████████████▌                                                             | 275/1360 [04:49<16:58,  1.06it/s] 20%|███████████████▋                                                             | 276/1360 [04:50<17:10,  1.05it/s] 20%|███████████████▋                                                             | 277/1360 [04:51<17:04,  1.06it/s] 20%|███████████████▋                                                             | 278/1360 [04:52<17:14,  1.05it/s] 21%|███████████████▊                                                             | 279/1360 [04:53<17:06,  1.05it/s] 21%|███████████████▊                                                             | 280/1360 [04:54<16:46,  1.07it/s] 21%|███████████████▉                                                             | 281/1360 [04:55<17:00,  1.06it/s] 21%|███████████████▉                                                             | 282/1360 [04:56<16:56,  1.06it/s] 21%|████████████████                                                             | 283/1360 [04:57<16:53,  1.06it/s] 21%|████████████████                                                             | 284/1360 [04:58<16:51,  1.06it/s] 21%|████████████████▏                                                            | 285/1360 [04:58<17:02,  1.05it/s] 21%|████████████████▏                                                            | 286/1360 [04:59<16:55,  1.06it/s] 21%|████████████████▏                                                            | 287/1360 [05:00<16:51,  1.06it/s] 21%|████████████████▎                                                            | 288/1360 [05:01<17:02,  1.05it/s] 21%|████████████████▎                                                            | 289/1360 [05:02<16:55,  1.05it/s] 21%|████████████████▍                                                            | 290/1360 [05:03<17:04,  1.04it/s] 21%|████████████████▍                                                            | 291/1360 [05:04<16:56,  1.05it/s] 21%|████████████████▌                                                            | 292/1360 [05:05<17:04,  1.04it/s] 22%|████████████████▌                                                            | 293/1360 [05:06<17:09,  1.04it/s] 22%|████████████████▋                                                            | 294/1360 [05:07<16:57,  1.05it/s] 22%|████████████████▋                                                            | 295/1360 [05:08<16:50,  1.05it/s] 22%|████████████████▊                                                            | 296/1360 [05:09<16:59,  1.04it/s] 22%|████████████████▊                                                            | 297/1360 [05:10<16:51,  1.05it/s] 22%|████████████████▊                                                            | 298/1360 [05:11<16:59,  1.04it/s] 22%|████████████████▉                                                            | 299/1360 [05:12<17:04,  1.04it/s] 22%|████████████████▉                                                            | 300/1360 [05:13<16:54,  1.05it/s] 22%|█████████████████                                                            | 301/1360 [05:14<16:46,  1.05it/s] 22%|█████████████████                                                            | 302/1360 [05:15<16:40,  1.06it/s] 22%|█████████████████▏                                                           | 303/1360 [05:16<16:22,  1.08it/s] 22%|█████████████████▏                                                           | 304/1360 [05:17<16:22,  1.08it/s] 22%|█████████████████▎                                                           | 305/1360 [05:18<16:36,  1.06it/s] 22%|█████████████████▎                                                           | 306/1360 [05:18<16:46,  1.05it/s] 23%|█████████████████▍                                                           | 307/1360 [05:19<16:25,  1.07it/s] 23%|█████████████████▍                                                           | 308/1360 [05:20<16:24,  1.07it/s] 23%|█████████████████▍                                                           | 309/1360 [05:21<16:22,  1.07it/s] 23%|█████████████████▌                                                           | 310/1360 [05:22<16:20,  1.07it/s] 23%|█████████████████▌                                                           | 311/1360 [05:23<16:21,  1.07it/s] 23%|█████████████████▋                                                           | 312/1360 [05:24<16:20,  1.07it/s] 23%|█████████████████▋                                                           | 313/1360 [05:25<16:33,  1.05it/s] 23%|█████████████████▊                                                           | 314/1360 [05:26<16:14,  1.07it/s] 23%|█████████████████▊                                                           | 315/1360 [05:27<16:00,  1.09it/s] 23%|█████████████████▉                                                           | 316/1360 [05:28<16:18,  1.07it/s] 23%|█████████████████▉                                                           | 317/1360 [05:29<16:30,  1.05it/s] 23%|██████████████████                                                           | 318/1360 [05:30<16:38,  1.04it/s] 23%|██████████████████                                                           | 319/1360 [05:31<16:16,  1.07it/s] 24%|██████████████████                                                           | 320/1360 [05:32<15:57,  1.09it/s] 24%|██████████████████▏                                                          | 321/1360 [05:32<16:01,  1.08it/s] 24%|██████████████████▏                                                          | 322/1360 [05:33<16:03,  1.08it/s] 24%|██████████████████▎                                                          | 323/1360 [05:34<16:03,  1.08it/s] 24%|██████████████████▎                                                          | 324/1360 [05:35<15:50,  1.09it/s] 24%|██████████████████▍                                                          | 325/1360 [05:36<15:41,  1.10it/s] 24%|██████████████████▍                                                          | 326/1360 [05:37<15:34,  1.11it/s] 24%|██████████████████▌                                                          | 327/1360 [05:38<15:43,  1.09it/s] 24%|██████████████████▌                                                          | 328/1360 [05:39<15:49,  1.09it/s] 24%|██████████████████▋                                                          | 329/1360 [05:40<16:06,  1.07it/s] 24%|██████████████████▋                                                          | 330/1360 [05:41<16:18,  1.05it/s] 24%|██████████████████▋                                                          | 331/1360 [05:42<16:13,  1.06it/s] 24%|██████████████████▊                                                          | 332/1360 [05:43<16:09,  1.06it/s] 24%|██████████████████▊                                                          | 333/1360 [05:44<16:06,  1.06it/s] 25%|██████████████████▉                                                          | 334/1360 [05:45<15:49,  1.08it/s] 25%|██████████████████▉                                                          | 335/1360 [05:45<15:52,  1.08it/s] 25%|███████████████████                                                          | 336/1360 [05:46<15:53,  1.07it/s] 25%|███████████████████                                                          | 337/1360 [05:47<15:37,  1.09it/s] 25%|███████████████████▏                                                         | 338/1360 [05:48<15:41,  1.09it/s] 25%|███████████████████▏                                                         | 339/1360 [05:49<15:44,  1.08it/s] 25%|███████████████████▎                                                         | 340/1360 [05:50<16:00,  1.06it/s] 25%|███████████████████▎                                                         | 341/1360 [05:51<15:57,  1.06it/s] 25%|███████████████████▎                                                         | 342/1360 [05:52<15:53,  1.07it/s] 25%|███████████████████▍                                                         | 343/1360 [05:53<15:51,  1.07it/s] 25%|███████████████████▍                                                         | 344/1360 [05:54<15:36,  1.08it/s] 25%|███████████████████▌                                                         | 345/1360 [05:55<15:38,  1.08it/s] 25%|███████████████████▌                                                         | 346/1360 [05:56<15:27,  1.09it/s] 26%|███████████████████▋                                                         | 347/1360 [05:57<15:45,  1.07it/s] 26%|███████████████████▋                                                         | 348/1360 [05:58<15:44,  1.07it/s] 26%|███████████████████▊                                                         | 349/1360 [05:58<15:30,  1.09it/s] 26%|███████████████████▊                                                         | 350/1360 [05:59<15:34,  1.08it/s] 26%|███████████████████▊                                                         | 351/1360 [06:00<15:22,  1.09it/s] 26%|███████████████████▉                                                         | 352/1360 [06:01<15:28,  1.09it/s] 26%|███████████████████▉                                                         | 353/1360 [06:02<15:32,  1.08it/s] 26%|████████████████████                                                         | 354/1360 [06:03<15:34,  1.08it/s] 26%|████████████████████                                                         | 355/1360 [06:04<15:34,  1.08it/s] 26%|████████████████████▏                                                        | 356/1360 [06:05<15:18,  1.09it/s] 26%|████████████████████▏                                                        | 357/1360 [06:06<15:37,  1.07it/s] 26%|████████████████████▎                                                        | 358/1360 [06:07<15:35,  1.07it/s] 26%|████████████████████▎                                                        | 359/1360 [06:08<15:21,  1.09it/s] 26%|████████████████████▍                                                        | 360/1360 [06:09<15:11,  1.10it/s] 27%|████████████████████▍                                                        | 361/1360 [06:10<15:17,  1.09it/s] 27%|████████████████████▍                                                        | 362/1360 [06:10<14:43,  1.13it/s] 27%|████████████████████▌                                                        | 363/1360 [06:11<14:44,  1.13it/s] 27%|████████████████████▌                                                        | 364/1360 [06:12<14:44,  1.13it/s] 27%|████████████████████▋                                                        | 365/1360 [06:13<14:57,  1.11it/s] 27%|████████████████████▋                                                        | 366/1360 [06:14<14:53,  1.11it/s] 27%|████████████████████▊                                                        | 367/1360 [06:15<14:49,  1.12it/s] 27%|████████████████████▊                                                        | 368/1360 [06:16<14:59,  1.10it/s] 27%|████████████████████▉                                                        | 369/1360 [06:17<14:50,  1.11it/s] 27%|████████████████████▉                                                        | 370/1360 [06:18<14:47,  1.12it/s] 27%|█████████████████████                                                        | 371/1360 [06:18<14:56,  1.10it/s] 27%|█████████████████████                                                        | 372/1360 [06:19<14:51,  1.11it/s] 27%|█████████████████████                                                        | 373/1360 [06:20<14:46,  1.11it/s] 28%|█████████████████████▏                                                       | 374/1360 [06:21<14:55,  1.10it/s] 28%|█████████████████████▏                                                       | 375/1360 [06:22<15:01,  1.09it/s] 28%|█████████████████████▎                                                       | 376/1360 [06:23<14:53,  1.10it/s] 28%|█████████████████████▎                                                       | 377/1360 [06:24<14:44,  1.11it/s] 28%|█████████████████████▍                                                       | 378/1360 [06:25<14:41,  1.11it/s] 28%|█████████████████████▍                                                       | 379/1360 [06:26<14:38,  1.12it/s] 28%|█████████████████████▌                                                       | 380/1360 [06:27<14:48,  1.10it/s] 28%|█████████████████████▌                                                       | 381/1360 [06:27<14:40,  1.11it/s] 28%|█████████████████████▋                                                       | 382/1360 [06:28<14:50,  1.10it/s] 28%|█████████████████████▋                                                       | 383/1360 [06:29<14:41,  1.11it/s] 28%|█████████████████████▋                                                       | 384/1360 [06:30<14:36,  1.11it/s] 28%|█████████████████████▊                                                       | 385/1360 [06:31<14:33,  1.12it/s] 28%|█████████████████████▊                                                       | 386/1360 [06:32<14:08,  1.15it/s] 28%|█████████████████████▉                                                       | 387/1360 [06:33<14:25,  1.12it/s] 29%|█████████████████████▉                                                       | 388/1360 [06:34<14:24,  1.12it/s] 29%|██████████████████████                                                       | 389/1360 [06:35<14:25,  1.12it/s] 29%|██████████████████████                                                       | 390/1360 [06:35<14:24,  1.12it/s] 29%|██████████████████████▏                                                      | 391/1360 [06:36<14:20,  1.13it/s] 29%|██████████████████████▏                                                      | 392/1360 [06:37<14:32,  1.11it/s] 29%|██████████████████████▎                                                      | 393/1360 [06:38<14:28,  1.11it/s] 29%|██████████████████████▎                                                      | 394/1360 [06:39<14:36,  1.10it/s] 29%|██████████████████████▎                                                      | 395/1360 [06:40<14:28,  1.11it/s] 29%|██████████████████████▍                                                      | 396/1360 [06:41<14:24,  1.11it/s] 29%|██████████████████████▍                                                      | 397/1360 [06:42<14:21,  1.12it/s] 29%|██████████████████████▌                                                      | 398/1360 [06:43<14:31,  1.10it/s] 29%|██████████████████████▌                                                      | 399/1360 [06:44<14:25,  1.11it/s] 29%|██████████████████████▋                                                      | 400/1360 [06:44<14:21,  1.11it/s] 29%|██████████████████████▋                                                      | 401/1360 [06:45<14:19,  1.12it/s] 30%|██████████████████████▊                                                      | 402/1360 [06:46<14:28,  1.10it/s] 30%|██████████████████████▊                                                      | 403/1360 [06:47<14:22,  1.11it/s] 30%|██████████████████████▊                                                      | 404/1360 [06:48<14:18,  1.11it/s] 30%|██████████████████████▉                                                      | 405/1360 [06:49<14:15,  1.12it/s] 30%|██████████████████████▉                                                      | 405/1360 [06:50<16:07,  1.01s/it]
Traceback (most recent call last):
  File "/root/autodl-tmp/Eedi/01-SFR-Embedding-Mistral/get_test_rank_result.py", line 69, in <module>
    predict_list = inference(predict_list, model, prompt, batch_size=rank_batch_size, max_length=rank_max_length)
  File "/root/autodl-tmp/Eedi/01-SFR-Embedding-Mistral/util.py", line 584, in inference
    scores = model.compute_score(list(df['predict_text'].values),
  File "/root/miniconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/root/autodl-tmp/Eedi/01-SFR-Embedding-Mistral/util.py", line 489, in compute_score
    outputs = self.model(**inputs, output_hidden_states=True)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 1174, in forward
    outputs = self.model(
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 978, in forward
    layer_outputs = decoder_layer(
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 718, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 660, in forward
    attn_output = self.o_proj(attn_output)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/bitsandbytes/nn/modules.py", line 468, in forward
    out = bnb.matmul_4bit(x, self.weight.t(), bias=bias, quant_state=self.weight.quant_state)
  File "/root/miniconda3/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py", line 579, in matmul_4bit
    return MatMul4Bit.apply(A, B, out, bias, quant_state)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/autograd/function.py", line 539, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/root/miniconda3/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py", line 509, in forward
    output = torch.nn.functional.linear(A, F.dequantize_4bit(B, quant_state).to(A.dtype).t(), bias)
KeyboardInterrupt
