nohup: ignoring input
model_path = /root/autodl-tmp/bert-models/Salesforce/SFR-Embedding-Mistral
lora_path  = ./model_save/v3_round1_qlora_rerun/epoch_19_model/adapter.bin
Loading checkpoint shards:   0%|                                                                                        | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|██████████████████████████▋                                                     | 1/3 [00:02<00:04,  2.16s/it]Loading checkpoint shards:  67%|█████████████████████████████████████████████████████▎                          | 2/3 [00:03<00:01,  1.94s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████| 3/3 [00:05<00:00,  1.68s/it]Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████| 3/3 [00:05<00:00,  1.77s/it]
Batches:   0%|                                                                                                         | 0/41 [00:00<?, ?it/s]Batches:   2%|██▎                                                                                              | 1/41 [00:00<00:38,  1.03it/s]Batches:   5%|████▋                                                                                            | 2/41 [00:01<00:24,  1.61it/s]Batches:   7%|███████                                                                                          | 3/41 [00:01<00:18,  2.01it/s]Batches:  10%|█████████▍                                                                                       | 4/41 [00:02<00:15,  2.37it/s]Batches:  12%|███████████▊                                                                                     | 5/41 [00:02<00:14,  2.53it/s]Batches:  15%|██████████████▏                                                                                  | 6/41 [00:02<00:13,  2.64it/s]Batches:  17%|████████████████▌                                                                                | 7/41 [00:02<00:11,  2.84it/s]Batches:  20%|██████████████████▉                                                                              | 8/41 [00:03<00:11,  2.99it/s]Batches:  22%|█████████████████████▎                                                                           | 9/41 [00:03<00:10,  3.09it/s]Batches:  24%|███████████████████████▍                                                                        | 10/41 [00:03<00:09,  3.22it/s]Batches:  27%|█████████████████████████▊                                                                      | 11/41 [00:04<00:09,  3.24it/s]Batches:  29%|████████████████████████████                                                                    | 12/41 [00:04<00:08,  3.35it/s]Batches:  32%|██████████████████████████████▍                                                                 | 13/41 [00:04<00:08,  3.42it/s]Batches:  34%|████████████████████████████████▊                                                               | 14/41 [00:05<00:07,  3.41it/s]Batches:  37%|███████████████████████████████████                                                             | 15/41 [00:05<00:07,  3.46it/s]Batches:  39%|█████████████████████████████████████▍                                                          | 16/41 [00:05<00:07,  3.43it/s]Batches:  41%|███████████████████████████████████████▊                                                        | 17/41 [00:05<00:06,  3.51it/s]Batches:  44%|██████████████████████████████████████████▏                                                     | 18/41 [00:06<00:06,  3.50it/s]Batches:  46%|████████████████████████████████████████████▍                                                   | 19/41 [00:06<00:06,  3.56it/s]Batches:  49%|██████████████████████████████████████████████▊                                                 | 20/41 [00:06<00:05,  3.57it/s]Batches:  51%|█████████████████████████████████████████████████▏                                              | 21/41 [00:06<00:05,  3.62it/s]Batches:  54%|███████████████████████████████████████████████████▌                                            | 22/41 [00:07<00:05,  3.79it/s]Batches:  56%|█████████████████████████████████████████████████████▊                                          | 23/41 [00:07<00:04,  3.84it/s]Batches:  59%|████████████████████████████████████████████████████████▏                                       | 24/41 [00:07<00:04,  3.83it/s]Batches:  61%|██████████████████████████████████████████████████████████▌                                     | 25/41 [00:07<00:04,  3.99it/s]Batches:  63%|████████████████████████████████████████████████████████████▉                                   | 26/41 [00:08<00:03,  4.07it/s]Batches:  66%|███████████████████████████████████████████████████████████████▏                                | 27/41 [00:08<00:03,  4.04it/s]Batches:  68%|█████████████████████████████████████████████████████████████████▌                              | 28/41 [00:08<00:03,  4.02it/s]Batches:  71%|███████████████████████████████████████████████████████████████████▉                            | 29/41 [00:08<00:02,  4.14it/s]Batches:  73%|██████████████████████████████████████████████████████████████████████▏                         | 30/41 [00:09<00:02,  4.21it/s]Batches:  76%|████████████████████████████████████████████████████████████████████████▌                       | 31/41 [00:09<00:02,  4.05it/s]Batches:  78%|██████████████████████████████████████████████████████████████████████████▉                     | 32/41 [00:09<00:02,  4.10it/s]Batches:  80%|█████████████████████████████████████████████████████████████████████████████▎                  | 33/41 [00:09<00:01,  4.07it/s]Batches:  83%|███████████████████████████████████████████████████████████████████████████████▌                | 34/41 [00:10<00:01,  4.18it/s]Batches:  85%|█████████████████████████████████████████████████████████████████████████████████▉              | 35/41 [00:10<00:01,  4.37it/s]Batches:  88%|████████████████████████████████████████████████████████████████████████████████████▎           | 36/41 [00:10<00:01,  4.32it/s]Batches:  90%|██████████████████████████████████████████████████████████████████████████████████████▋         | 37/41 [00:10<00:00,  4.30it/s]Batches:  93%|████████████████████████████████████████████████████████████████████████████████████████▉       | 38/41 [00:11<00:00,  4.29it/s]Batches:  95%|███████████████████████████████████████████████████████████████████████████████████████████▎    | 39/41 [00:11<00:00,  4.39it/s]Batches:  98%|█████████████████████████████████████████████████████████████████████████████████████████████▋  | 40/41 [00:11<00:00,  4.54it/s]Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 41/41 [00:11<00:00,  5.04it/s]Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 41/41 [00:11<00:00,  3.53it/s]
train.shape = (3500, 18) valid.shape = (870, 18)
Batches:   0%|                                                                                                         | 0/55 [00:00<?, ?it/s]Batches:   2%|█▊                                                                                               | 1/55 [00:03<03:10,  3.53s/it]Batches:   4%|███▌                                                                                             | 2/55 [00:06<02:42,  3.06s/it]Batches:   5%|█████▎                                                                                           | 3/55 [00:08<02:22,  2.75s/it]Batches:   7%|███████                                                                                          | 4/55 [00:10<02:12,  2.59s/it]Batches:   9%|████████▊                                                                                        | 5/55 [00:13<02:01,  2.44s/it]Batches:  11%|██████████▌                                                                                      | 6/55 [00:15<01:52,  2.30s/it]Batches:  13%|████████████▎                                                                                    | 7/55 [00:17<01:45,  2.20s/it]Batches:  15%|██████████████                                                                                   | 8/55 [00:19<01:39,  2.11s/it]Batches:  16%|███████████████▊                                                                                 | 9/55 [00:21<01:35,  2.08s/it]Batches:  18%|█████████████████▍                                                                              | 10/55 [00:23<01:31,  2.03s/it]Batches:  20%|███████████████████▏                                                                            | 11/55 [00:24<01:26,  1.96s/it]Batches:  22%|████████████████████▉                                                                           | 12/55 [00:26<01:22,  1.93s/it]Batches:  24%|██████████████████████▋                                                                         | 13/55 [00:28<01:20,  1.92s/it]Batches:  25%|████████████████████████▍                                                                       | 14/55 [00:30<01:16,  1.87s/it]Batches:  27%|██████████████████████████▏                                                                     | 15/55 [00:32<01:16,  1.91s/it]Batches:  29%|███████████████████████████▉                                                                    | 16/55 [00:34<01:11,  1.83s/it]Batches:  31%|█████████████████████████████▋                                                                  | 17/55 [00:35<01:07,  1.78s/it]Batches:  33%|███████████████████████████████▍                                                                | 18/55 [00:37<01:04,  1.74s/it]Batches:  35%|█████████████████████████████████▏                                                              | 19/55 [00:38<00:59,  1.66s/it]Batches:  36%|██████████████████████████████████▉                                                             | 20/55 [00:40<00:59,  1.69s/it]Batches:  38%|████████████████████████████████████▋                                                           | 21/55 [00:42<00:55,  1.64s/it]Batches:  40%|██████████████████████████████████████▍                                                         | 22/55 [00:43<00:54,  1.64s/it]Batches:  42%|████████████████████████████████████████▏                                                       | 23/55 [00:45<00:50,  1.59s/it]Batches:  44%|█████████████████████████████████████████▉                                                      | 24/55 [00:46<00:47,  1.52s/it]Batches:  45%|███████████████████████████████████████████▋                                                    | 25/55 [00:47<00:44,  1.48s/it]Batches:  47%|█████████████████████████████████████████████▍                                                  | 26/55 [00:49<00:42,  1.48s/it]Batches:  49%|███████████████████████████████████████████████▏                                                | 27/55 [00:50<00:40,  1.46s/it]Batches:  51%|████████████████████████████████████████████████▊                                               | 28/55 [00:52<00:38,  1.42s/it]Batches:  53%|██████████████████████████████████████████████████▌                                             | 29/55 [00:53<00:36,  1.40s/it]Batches:  55%|████████████████████████████████████████████████████▎                                           | 30/55 [00:54<00:34,  1.39s/it]Batches:  56%|██████████████████████████████████████████████████████                                          | 31/55 [00:56<00:32,  1.37s/it]Batches:  58%|███████████████████████████████████████████████████████▊                                        | 32/55 [00:57<00:30,  1.35s/it]Batches:  60%|█████████████████████████████████████████████████████████▌                                      | 33/55 [00:58<00:29,  1.33s/it]Batches:  62%|███████████████████████████████████████████████████████████▎                                    | 34/55 [01:00<00:28,  1.35s/it]Batches:  64%|█████████████████████████████████████████████████████████████                                   | 35/55 [01:01<00:26,  1.31s/it]Batches:  65%|██████████████████████████████████████████████████████████████▊                                 | 36/55 [01:02<00:24,  1.27s/it]Batches:  67%|████████████████████████████████████████████████████████████████▌                               | 37/55 [01:03<00:22,  1.24s/it]Batches:  69%|██████████████████████████████████████████████████████████████████▎                             | 38/55 [01:04<00:20,  1.21s/it]Batches:  71%|████████████████████████████████████████████████████████████████████                            | 39/55 [01:06<00:19,  1.19s/it]Batches:  73%|█████████████████████████████████████████████████████████████████████▊                          | 40/55 [01:07<00:17,  1.19s/it]Batches:  75%|███████████████████████████████████████████████████████████████████████▌                        | 41/55 [01:08<00:16,  1.18s/it]Batches:  76%|█████████████████████████████████████████████████████████████████████████▎                      | 42/55 [01:09<00:15,  1.18s/it]Batches:  78%|███████████████████████████████████████████████████████████████████████████                     | 43/55 [01:10<00:13,  1.17s/it]Batches:  80%|████████████████████████████████████████████████████████████████████████████▊                   | 44/55 [01:11<00:12,  1.16s/it]Batches:  82%|██████████████████████████████████████████████████████████████████████████████▌                 | 45/55 [01:12<00:11,  1.16s/it]Batches:  84%|████████████████████████████████████████████████████████████████████████████████▎               | 46/55 [01:14<00:10,  1.20s/it]Batches:  85%|██████████████████████████████████████████████████████████████████████████████████              | 47/55 [01:15<00:09,  1.15s/it]Batches:  87%|███████████████████████████████████████████████████████████████████████████████████▊            | 48/55 [01:16<00:07,  1.12s/it]Batches:  89%|█████████████████████████████████████████████████████████████████████████████████████▌          | 49/55 [01:17<00:06,  1.12s/it]Batches:  91%|███████████████████████████████████████████████████████████████████████████████████████▎        | 50/55 [01:18<00:05,  1.09s/it]Batches:  93%|█████████████████████████████████████████████████████████████████████████████████████████       | 51/55 [01:19<00:04,  1.06s/it]Batches:  95%|██████████████████████████████████████████████████████████████████████████████████████████▊     | 52/55 [01:20<00:03,  1.05s/it]Batches:  96%|████████████████████████████████████████████████████████████████████████████████████████████▌   | 53/55 [01:21<00:02,  1.04s/it]Batches:  98%|██████████████████████████████████████████████████████████████████████████████████████████████▎ | 54/55 [01:22<00:01,  1.01s/it]Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [01:23<00:00,  1.11it/s]Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [01:23<00:00,  1.51s/it]
Batches:   0%|                                                                                                         | 0/14 [00:00<?, ?it/s]Batches:   7%|██████▉                                                                                          | 1/14 [00:03<00:43,  3.37s/it]Batches:  14%|█████████████▊                                                                                   | 2/14 [00:05<00:29,  2.48s/it]Batches:  21%|████████████████████▊                                                                            | 3/14 [00:06<00:23,  2.14s/it]Batches:  29%|███████████████████████████▋                                                                     | 4/14 [00:08<00:19,  1.98s/it]Batches:  36%|██████████████████████████████████▋                                                              | 5/14 [00:10<00:16,  1.84s/it]Batches:  43%|█████████████████████████████████████████▌                                                       | 6/14 [00:11<00:13,  1.70s/it]Batches:  50%|████████████████████████████████████████████████▌                                                | 7/14 [00:13<00:11,  1.60s/it]Batches:  57%|███████████████████████████████████████████████████████▍                                         | 8/14 [00:14<00:08,  1.49s/it]Batches:  64%|██████████████████████████████████████████████████████████████▎                                  | 9/14 [00:15<00:06,  1.39s/it]Batches:  71%|████████████████████████████████████████████████████████████████████▌                           | 10/14 [00:16<00:05,  1.33s/it]Batches:  79%|███████████████████████████████████████████████████████████████████████████▍                    | 11/14 [00:17<00:03,  1.28s/it]Batches:  86%|██████████████████████████████████████████████████████████████████████████████████▎             | 12/14 [00:19<00:02,  1.25s/it]Batches:  93%|█████████████████████████████████████████████████████████████████████████████████████████▏      | 13/14 [00:20<00:01,  1.21s/it]Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:20<00:00,  1.03s/it]Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:20<00:00,  1.49s/it]
train recall rate = 0.9982857142857143
train mapk score = 0.7762288317147493
valid recall rate = 0.8758620689655172
valid mapk score = 0.4775474895433248
len(bge_recall_train) = 3500
len(bge_recall_valid) = 870
len(bge_rank_train) = 3500
len(bge_rank_valid) = 870
